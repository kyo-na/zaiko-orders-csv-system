<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>在庫</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="h3 mb-0">在庫</h1>
      <div class="d-flex gap-2">
        <a class="btn btn-outline-secondary" href="/">注文票</a>
        <a class="btn btn-outline-secondary" href="/history/">注文履歴</a>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-sm table-striped align-middle">
        <thead>
          <tr>
            <th>品目</th>
            <th>賞味期限</th>
            <th>在庫</th>
            <th>補填ライン</th>
            <th>アラート</th>
          </tr>
        </thead>
        <tbody id="body"></tbody>
      </table>
    </div>
  </div>

<script>
var elBody = document.getElementById('body');
function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, function(m){
    return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]);
  });
}
async function loadInv(){
  var data = await fetch('/api/inventory/').then(function(r){ return r.json(); });
  var rows = data.items || [];
  elBody.innerHTML = '';
  for (var i=0;i<rows.length;i++){
    var x = rows[i];
    var tr = document.createElement('tr');
    tr.innerHTML = ''
      + '<td>' + escapeHtml(x.item) + '</td>'
      + '<td>' + escapeHtml(x.expiry) + '</td>'
      + '<td>' + escapeHtml(x.qty) + '</td>'
      + '<td>' + escapeHtml(x.refill_line) + '</td>'
      + '<td>' + escapeHtml(x.alert || '') + '</td>';
    elBody.appendChild(tr);
  }
}
loadInv();
</script>
</body>
</html>
